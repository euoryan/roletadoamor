<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roleta do Amor <3</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #ff3e6c;
            --accent: #6b46c1;
            --text: #2d3748;
            --bg: #ffffff;
            --radius: 16px;
            --radius-sm: 8px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-image: linear-gradient(135deg, #f9fafb 0%, #eff6ff 100%);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
        }

        .container {
            max-width: 600px;
            width: 100%;
            margin: 1rem auto;
            background-color: var(--bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            animation: fadeIn 0.6s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            position: relative;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
        }

        /* Wheel Styles */
        .wheel-container {
            width: 280px;
            height: 280px;
            position: relative;
            margin: 0 auto 2rem;
        }

        .wheel-outer {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        .wheel-inner {
            width: 94%;
            height: 94%;
            border-radius: 50%;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wheel {
            width: 90%;
            height: 90%;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            background-color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 5s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }

        .wheel-section {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform-origin: center;
            clip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 100%);
        }

        .section-content {
            position: absolute;
            left: 70%;
            top: 25%;
            transform: translate(-50%, -50%) rotate(45deg);
            width: 80px;
            text-align: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .section-content i {
            font-size: 16px;
            margin-bottom: 5px;
            display: block;
        }

        .wheel-center {
            position: absolute;
            width: 50px;
            height: 50px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 22px;
            z-index: 10;
            border: 3px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .wheel-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 30px;
            z-index: 5;
        }

        .wheel-pointer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--primary);
            clip-path: polygon(50% 100%, 0 0, 100% 0);
        }

        /* Buttons */
        .button-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .button {
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .button-primary {
            background-color: var(--primary);
            color: white;
        }

        .button-primary:hover {
            background-color: #e52a58;
            transform: translateY(-2px);
        }

        .button-secondary {
            background-color: var(--text);
            color: white;
        }

        .button-secondary:hover {
            background-color: #1e2a36;
            transform: translateY(-2px);
        }

        .button:disabled {
            background-color: #e0e0e0;
            color: #9e9e9e;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .button-link {
            text-decoration: none;
            display: inline-flex;
            justify-content: center;
        }

        /* Spins Counter */
        .spins-counter {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 1.5rem;
            color: var(--text);
            font-weight: 500;
            background-color: rgba(0, 0, 0, 0.03);
            padding: 0.7rem 1.2rem;
            border-radius: 50px;
        }

        .spin-token {
            display: inline-block;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: var(--primary);
            transition: all 0.3s ease;
        }

        .spin-token.used {
            background-color: #e0e0e0;
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: white;
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-header i {
            font-size: 1.4rem;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-map {
            width: 100%;
            height: 250px;
        }

        .modal-map iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .modal-actions {
            padding: 1.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* Success message */
        .success-message {
            text-align: center;
            margin-top: 1rem;
            padding: 1rem;
            background-color: #e8f5e9;
            border-radius: var(--radius-sm);
            color: #2e7d32;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* Timer display */
        .timer-display {
            margin-top: 1rem;
            text-align: center;
            color: var(--text);
            font-size: 0.9rem;
        }

        /* Responsive Styles */
        @media (max-width: 480px) {
            .wheel-container {
                width: 240px;
                height: 240px;
            }
            
            .button-container {
                flex-direction: column;
                width: 100%;
            }
            
            .button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Date Especial</h1>
            <p>Gire a roleta e descubra onde será nosso jantar romântico. Você tem 3 giros para escolher o local perfeito!</p>
        </div>

        <div class="content">
            <div class="wheel-container">
                <div class="wheel-outer">
                    <div class="wheel-inner">
                        <div class="wheel" id="wheel">
                            <!-- Sections will be added via JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="wheel-center">
                    <i class="fas fa-heart"></i>
                </div>
                <div class="wheel-pointer"></div>
            </div>

            <div class="button-container">
                <button id="spinBtn" class="button button-primary">
                    <i class="fas fa-sync-alt"></i>
                    Girar a Roleta
                </button>
            </div>

            <div class="spins-counter" id="spinsCounter">
                <span>Giros restantes:</span>
                <span class="spin-token" id="spin1"></span>
                <span class="spin-token" id="spin2"></span>
                <span class="spin-token" id="spin3"></span>
            </div>
            
            <div class="timer-display" id="timerDisplay"></div>
        </div>
    </div>

    <!-- Modal result -->
    <div class="modal-overlay" id="resultModal">
        <div class="modal">
            <div class="modal-header">
                <i id="restaurantIcon" class="fas fa-utensils"></i>
                <h2 id="restaurantName"></h2>
            </div>
            <div class="modal-map" id="map">
                <!-- Map will be loaded here -->
            </div>
            <div class="modal-actions" id="modalActions">
                <button id="acceptBtn" class="button button-primary">
                    <i class="fas fa-check"></i>
                    Escolher Este Restaurante
                </button>
                <button id="rejectBtn" class="button button-secondary">
                    <i class="fas fa-redo"></i>
                    Tentar Novamente
                </button>
            </div>
        </div>
    </div>

    <script>
        // Dados dos restaurantes
        const restaurants = [
    {
        name: "Blackpot Restaurant",
        description: "Conhecido por sua culinária autêntica e ambiente acolhedor. Um excelente lugar para apreciar pratos elaborados e compartilhar momentos especiais.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14555.94245930117!2d-48.60377168998433!3d-27.612406748231987!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95273816195b3fe7%3A0xa51af3a95b173aa0!2sBlackpot%20Restaurant!5e0!3m2!1spt-BR!2sbr!4v1741356442805!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/TN4ipZTHUp2isDAo8",
        color: "#FF5252",
        icon: "fa-utensils"
    },
    {
        name: "Osli Restaurante",
        description: "Elegante restaurante com decoração refinada e menu que valoriza os sabores locais. Perfeito para uma noite romântica com pratos cuidadosamente preparados.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.208911226234!2d-48.553954524633056!3d-27.587052021716403!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9527393d97d1762d%3A0xc59b919a85bfcc8c!2sOsli%20Restaurante!5e0!3m2!1spt-BR!2sbr!4v1741356463493!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/3Vzoha8WXihr5vh28",
        color: "#536DFE",
        icon: "fa-wine-glass-alt"
    },
    {
        name: "Bistrô da Praça",
        description: "Um charmoso bistrô com ambiente intimista e cardápio sazonal. Ótimo para degustar pratos delicados acompanhados de um bom vinho em um ambiente descontraído.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.1464998671427!2d-48.548460824633125!3d-27.588987321799163!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9527383d8788227f%3A0x36eb1a225e36b86b!2zQmlzdHLDtCBkYSBQcmHDp2E!5e0!3m2!1spt-BR!2sbr!4v1741356476501!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/rhnnUmHoeHbLKDK56",
        color: "#9C27B0",
        icon: "fa-coffee"
    },
    {
        name: "Santa Cucina",
        description: "Autêntica culinária italiana em um ambiente que remete à Itália. Experimente as massas artesanais e os risotos cremosos preparados com ingredientes frescos e de qualidade.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.1464998671427!2d-48.548460824633125!3d-27.588987321799163!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x952738198f442d33%3A0x2e5aa253187223ed!2sG%C3%81LIA%20RESTAURANTE!5e0!3m2!1spt-BR!2sbr!4v1741356487276!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/tYnKKBHuyM4VFfVE7",
        color: "#8BC34A",
        icon: "fa-pizza-slice"
    },
    {
        name: "Píer 54 Restaurante",
        description: "Localizado em um ponto privilegiado, oferece uma experiência gastronômica com vista. Especializado em frutos do mar frescos e pratos contemporâneos.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.2291465652456!2d-48.55305112463308!3d-27.586424521689484!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x952737f61d6cad93%3A0x4794b9616eb83760!2sP%C3%ADer%2054%20Restaurante!5e0!3m2!1spt-BR!2sbr!4v1741356496643!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/Bt5EtFM1Zg2yimZ49",
        color: "#009688",
        icon: "fa-fish"
    },
    {
        name: "Forneria Catarina São José",
        description: "Pizzaria artesanal com forno à lenha que traz o verdadeiro sabor da pizza italiana. Ambiente agradável e pizzas preparadas com ingredientes selecionados.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3535.7718469784554!2d-48.61371712463258!3d-27.600602222296292!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x952737f4ef61e571%3A0x5ec3be8e68653cd7!2sForneria%20Catarina%20S%C3%A3o%20Jos%C3%A9!5e0!3m2!1spt-BR!2sbr!4v1741356506549!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/37NqpVTbS4xNUaYq7",
        color: "#FF9800",
        icon: "fa-pizza-slice"
    },
    {
        name: "El Señor Asador de Brasa",
        description: "Autêntica parrilla com os melhores cortes de carne preparados na brasa. Ambiente rústico e aconchegante para uma refeição memorável com muito sabor.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.2385465824295!2d-48.55021022463315!3d-27.586133021677004!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9527397e5fb01c83%3A0x42c5ae94f40e7675!2sEl%20Se%C3%B1or%20Asador%20de%20Brasa!5e0!3m2!1spt-BR!2sbr!4v1741356531078!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/XATMJQ12Aw8ERGWf9",
        color: "#795548",
        icon: "fa-drumstick-bite"
    },
    {
        name: "Outback Steakhouse",
        description: "Famosa steakhouse australiana conhecida por seus cortes generosos e pelo característico Bloomin' Onion. Ambiente animado e pratos saborosos para uma experiência diferente.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d8408.31663177688!2d-48.65085092598623!3d-27.616423085544216!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x952735cdaa28ffbd%3A0x4cb5f70eb5cab7c6!2sRestaurante%20Outback%20Steakhouse!5e0!3m2!1spt-BR!2sbr!4v1741356562454!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/HkYooddBJ4q3NpKE6",
        color: "#FF5722",
        icon: "fa-drumstick-bite"
    },
    {
        name: "Little Carbone",
        description: "Especializado em carnes premium preparadas no carvão. Atmosfera moderna e sofisticada com menu que valoriza ingredientes de qualidade e técnicas precisas de preparo.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3537.288237389849!2d-48.50166782463456!3d-27.55356362028453!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x952739cd7fb7d557%3A0x2f6b2d5be9c363c9!2sLittle%20Carbone!5e0!3m2!1spt-BR!2sbr!4v1741356579902!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/UuAxSuYcdNP6oMDq6",
        color: "#607D8B",
        icon: "fa-fire"
    },
    {
        name: "Dom Piero Churrasco, Galeto e Massas",
        description: "Um restaurante versátil que une o melhor do churrasco, do galeto e da culinária italiana. Ideal para quem deseja variedade em um ambiente familiar e acolhedor.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.2564047505884!2d-48.61621222463328!3d-27.58557922165344!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x952749dca8f53979%3A0xad093208e611a4fa!2sDom%20Piero%20Churrasco%2C%20Galeto%20e%20Massas!5e0!3m2!1spt-BR!2sbr!4v1741356593244!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/JKgCFTmnPvvc4sx18",
        color: "#673AB7",
        icon: "fa-utensils"
    },
    {
        name: "Santo Antonio de Lisboa",
        description: "Localizado em um charmoso bairro histórico, oferece uma experiência única com vista para o mar e pratos que valorizam os ingredientes e a cultura local.",
        mapEmbed: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.2564047505884!2d-48.61621222463328!3d-27.58557922165344!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95274692c1cfaca5%3A0x9893a62751be06a5!2sSanto%20Antonio%20de%20Lisboa%2C%20Florian%C3%B3polis%20-%20SC!5e0!3m2!1spt-BR!2sbr!4v1741356604109!5m2!1spt-BR!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>',
        url: "https://maps.app.goo.gl/qE4dqn3R4GR8j3TY6",
        color: "#3F51B5",
        icon: "fa-utensils"
    }
];

        // Constantes para cookies
        const SPINS_COOKIE_NAME = "roleta_spins_left";
        const RESET_TIME_COOKIE_NAME = "roleta_reset_time";

        // Variáveis globais
        let currentRestaurant = null;
        let currentAngle = 0;
        let isSpinning = false;
        let spinsLeft = 3;
        let resetTime = null;

        // Elementos DOM
        const wheel = document.getElementById('wheel');
        const spinBtn = document.getElementById('spinBtn');
        const acceptBtn = document.getElementById('acceptBtn');
        const rejectBtn = document.getElementById('rejectBtn');
        const resultModal = document.getElementById('resultModal');
        const restaurantName = document.getElementById('restaurantName');
        const restaurantIcon = document.getElementById('restaurantIcon');
        const mapContainer = document.getElementById('map');
        const modalActions = document.getElementById('modalActions');
        const timerDisplay = document.getElementById('timerDisplay');

        // Função para definir um cookie
        function setCookie(name, value, daysToExpire) {
            const date = new Date();
            date.setTime(date.getTime() + (daysToExpire * 24 * 60 * 60 * 1000));
            const expires = "expires=" + date.toUTCString();
            document.cookie = name + "=" + value + ";" + expires + ";path=/";
        }

        // Função para obter o valor de um cookie
        function getCookie(name) {
            const cname = name + "=";
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                let cookie = cookies[i].trim();
                if (cookie.indexOf(cname) === 0) {
                    return cookie.substring(cname.length, cookie.length);
                }
            }
            return "";
        }

        // Função para carregar dados dos cookies
        function loadSpinData() {
            const savedSpins = getCookie(SPINS_COOKIE_NAME);
            const savedResetTime = getCookie(RESET_TIME_COOKIE_NAME);
            
            if (savedSpins && savedResetTime) {
                const now = new Date().getTime();
                resetTime = parseInt(savedResetTime);
                
                // Verifica se já passou o tempo de reset
                if (now >= resetTime) {
                    // Reseta os giros
                    spinsLeft = 3;
                    resetTime = now + (24 * 60 * 60 * 1000); // 24 horas a partir de agora
                    saveCookies();
                } else {
                    // Ainda dentro do período de 24h, usar o valor salvo
                    spinsLeft = parseInt(savedSpins);
                    
                    // Atualiza o timer
                    updateTimerDisplay();
                    // Inicia o contador regressivo
                    setInterval(updateTimerDisplay, 1000);
                }
            } else {
                // Primeira vez usando, configura os valores padrão
                spinsLeft = 3;
                resetTime = new Date().getTime() + (24 * 60 * 60 * 1000); // 24 horas a partir de agora
                saveCookies();
            }
            
            updateSpinsCounter();
            updateButtonState();
        }

        // Função para salvar dados nos cookies
        function saveCookies() {
            setCookie(SPINS_COOKIE_NAME, spinsLeft.toString(), 7); // Cookie expira em 7 dias
            setCookie(RESET_TIME_COOKIE_NAME, resetTime.toString(), 7);
        }

        // Atualiza o display do temporizador
        function updateTimerDisplay() {
            if (!resetTime || spinsLeft > 0) return;
            
            const now = new Date().getTime();
            const timeLeft = resetTime - now;
            
            if (timeLeft <= 0) {
                // Tempo expirou, reiniciar
                spinsLeft = 3;
                resetTime = now + (24 * 60 * 60 * 1000);
                saveCookies();
                updateSpinsCounter();
                updateButtonState();
                timerDisplay.textContent = "";
                return;
            }
            
            // Calcular horas, minutos e segundos restantes
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            timerDisplay.textContent = `Próximos giros disponíveis em: ${hours}h ${minutes}m ${seconds}s`;
        }

        // Atualiza o estado do botão de girar
        function updateButtonState() {
            if (spinsLeft <= 0) {
                spinBtn.disabled = true;
            } else {
                spinBtn.disabled = false;
            }
        }

        // Inicializar a roleta
        function initWheel() {
            // Ângulo para cada restaurante
            const sectionAngle = 360 / restaurants.length;
            
            // Limpar a roda
            wheel.innerHTML = '';

            // Criar seções da roleta
            restaurants.forEach((restaurant, index) => {
                const section = document.createElement('div');
                section.className = 'wheel-section';
                section.style.backgroundColor = restaurant.color;
                
                // Rotação da seção (distribuir uniformemente)
                const rotationAngle = index * sectionAngle;
                section.style.transform = `rotate(${rotationAngle}deg)`;
                
                // Conteúdo da seção
                const content = document.createElement('div');
                content.className = 'section-content';
                
                // Ajustar o conteúdo para ficar no centro da seção
                content.style.transform = `translate(-50%, -50%) rotate(${90 - rotationAngle}deg)`;
                
                const icon = document.createElement('i');
                icon.className = `fas ${restaurant.icon}`;
                content.appendChild(icon);
                
                const name = document.createElement('span');
                name.textContent = restaurant.name;
                content.appendChild(name);
                
                section.appendChild(content);
                wheel.appendChild(section);
            });
        }

        // Girar a roleta
        function spinWheel() {
            if (isSpinning || spinsLeft <= 0) return;

            isSpinning = true;
            spinsLeft--;
            updateSpinsCounter();
            saveCookies();

            // Desabilitar botão durante o giro
            spinBtn.disabled = true;

            // Gerar ângulo aleatório (entre 2 e 4 voltas completas)
            const spinAngle = 2 * 360 + Math.floor(Math.random() * 2 * 360);
            const totalAngle = currentAngle + spinAngle;

            // Aplicar animação de giro
            wheel.style.transition = 'transform 4s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
            wheel.style.transform = `rotate(${totalAngle}deg)`;

            // Atualizar ângulo atual
            currentAngle = totalAngle;

            // Tempo para terminar a animação
            setTimeout(() => {
                isSpinning = false;
                updateButtonState();

                // Determinar o restaurante escolhido (ângulo normalizado)
                const normalizedAngle = (totalAngle % 360);
                const sectionAngle = 360 / restaurants.length;
                const selectedIndex = Math.floor(normalizedAngle / sectionAngle) % restaurants.length;
                
                // Corrigir o índice para considerar a rotação revertida
                const correctedIndex = (restaurants.length - selectedIndex) % restaurants.length;
                
                currentRestaurant = restaurants[correctedIndex];
                showRestaurantModal(currentRestaurant);
            }, 4000);
        }

        // Exibir modal com informações do restaurante
        function showRestaurantModal(restaurant) {
            restaurantName.textContent = restaurant.name;
            restaurantIcon.className = `fas ${restaurant.icon}`;
            mapContainer.innerHTML = restaurant.mapEmbed;

            // Configurar botões do modal
            if (spinsLeft > 0) {
                acceptBtn.style.display = 'flex';
                rejectBtn.style.display = 'flex';
            } else {
                acceptBtn.style.display = 'flex';
                rejectBtn.style.display = 'none';
            }

            // Exibir o modal
            resultModal.classList.add('active');
        }

        // Atualizar contador de giros
        function updateSpinsCounter() {
            const spinTokens = document.querySelectorAll('.spin-token');
            
            spinTokens.forEach((token, index) => {
                if (index < 3 - spinsLeft) {
                    token.classList.add('used');
                } else {
                    token.classList.remove('used');
                }
            });
            
            // Mostrar ou esconder o timer baseado nos giros restantes
            if (spinsLeft <= 0) {
                updateTimerDisplay();
                // Inicia o contador regressivo se não estiver rodando
                if (!window.timerInterval) {
                    window.timerInterval = setInterval(updateTimerDisplay, 1000);
                }
            }
        }

        // Aceitar restaurante
        function acceptRestaurant() {
            // Preparar mensagem para WhatsApp
            const message = `Oi amor, escolhi o restaurante ${currentRestaurant.name} para nosso encontro, veja no mapa o restaurante "${currentRestaurant.name}" ${currentRestaurant.url}`;
            const encodedMessage = encodeURIComponent(message);
            const whatsappLink = `https://wa.me/5548984613946?text=${encodedMessage}`;

            // Limpar ações do modal
            modalActions.innerHTML = '';
            
            // Adicionar mensagem de sucesso e botão do maps
            const successMessage = document.createElement('div');
            successMessage.className = 'success-message';
            successMessage.innerHTML = `<i class="fas fa-check-circle"></i> Ótima escolha!`;
            modalActions.appendChild(successMessage);
            
            const mapButton = document.createElement('a');
            mapButton.href = currentRestaurant.url;
            mapButton.target = '_blank';
            mapButton.className = 'button button-secondary button-link';
            mapButton.innerHTML = '<i class="fas fa-map-marker-alt"></i> Ver no Google Maps';
            modalActions.appendChild(mapButton);
            
            // Abrir WhatsApp automaticamente
            window.open(whatsappLink, '_blank');
        }

        // Rejeitar restaurante e fechar o modal
        function rejectRestaurant() {
            resultModal.classList.remove('active');
        }

        // Inicializar a aplicação
        function init() {
            // Carregar dados dos cookies
            loadSpinData();
            
            // Inicializar a roleta
            initWheel();

            // Event listeners
            spinBtn.addEventListener('click', spinWheel);
            acceptBtn.addEventListener('click', acceptRestaurant);
            rejectBtn.addEventListener('click', rejectRestaurant);
        }

        // Inicializar quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>